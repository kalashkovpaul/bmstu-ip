\chapter{Аналитическая часть}
%В этом разделе будут рассмотрены классический алгоритм работы шифровальной машины <<Энигма>>, а также её вариант, использованный во время Второй мировой войны, приведён пример преобразования буквы, а также подсчитано количество комбинаций <<Энигмы>> с 3 роторами.


%\section{Основные детали}
%
%Шифровальная машина <<Энигма>> состоит из следующих деталей: роторы, входное колесо, рефлектор, а также коммутационная панель.
%
%\subsection{Роторы}
%
%<<Энигма>> предназначена для шифрации сообщений, написанных на английском языке.
%Ротор --- прикреплённый к шестерёнке с 26 зубцами (по одному на каждую букву алфавита) элемент, предназначенный для преобразования одной буквы в другую.
%
%В разное время в разных реализациях <<Энигмы>> использовалось разное количество роторов. Во время Второй мировой войны использовались 3 ротора, причём всего было 10 роторов, преобразовывающих буквы в соответствии с таблицей \ref{tbl:rotors}.
%
%\begin{table}[h]
%\small
%\setlength{\tabcolsep}{3pt}
%	\begin{center}
%		\begin{threeparttable}
%		\captionsetup{justification=raggedright,singlelinecheck=off}
%		\caption{\label{tbl:rotors} Преобразования роторов <<Энигмы>>}
%		\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|}
%			\hline
%			Ротор & A & B & C & D & E & F & G & H & I & J & K & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z \\
%			\hline
%			I & E & K & M & F & L & G & D & Q & V & Z & N & T & O & W & Y & H & X & U & S & P & A & I & B & R & C & J \\
%			\hline
%			II & A & J & D & K & S & I & R & U & X & B & L & H & W & T & M & C & Q & G & Z & N & P & Y & F & V & O & E \\
%			\hline
%			III & B & D & F & H & J & L & C & P & R & T & X & V & Z & N & Y & E & I & W & G & A & K & M & U & S & Q & O \\
%			\hline
%			IV & E & S & O & V & P & Z & J & A & Y & Q & U & I & R & H & X & L & N & F & T & G & K & D & C & M & W & B \\
%			\hline
%			V& V & Z & B & R & G & I & T & Y & U & P & S & D & N & H & L & X & A & W & M & J & Q & O & F & E & C & K \\
%			\hline
%			VI & J & P & G & V & O & U & M & F & Y & Q & B & E & N & H & Z & R & D & K & A & S & X & L & I & C & T & W \\
%			\hline
%			VII & N & Z & J & H & G & R & C & X & M & Y & S & W & B & O & U & F & A & I & V & L & P & E & K & Q & D & T \\
%			\hline
%			VIII & F & K & Q & H & T & L & X & O & C & B & J & S & P & D & Z & R & A & M & E & W & N & I & U & Y & G & V \\
%			\hline
%			IX & L & E & Y & J & V & C & N & I & X & W & P & B & Q & M & D & R & T & A & K & Z & G & F & U & H & O & S \\
%			\hline
%			X & F & S & O & K & A & N & U & E & R & H & M & B & T & I & Y & C & W & L & Q & P & Z & X & V & G & J & D \\
%			\hline
%		\end{tabular}
%		\end{threeparttable}
%	\end{center}
%	
%\end{table}
%
%\subsection{Входное колесо}
%
%Входное колесо --- элемент, позволяющий выставить роторы в необходимые значения. 
%В физической машине было 3 отверстия, позволяющих просматривать, в каком состоянии находится каждый ротор.
%Положения роторов является ключевым для процесса шифрования, поскольку в зависимости от них одно и то же сообщение будет зашифровано по-разному и будет требовать сответствующих начальных значений роторов для дешифрации.
%
%\subsection{Рефлектор}
%
%Рефлектор --- элемент, попарно соединяющий контакты последнего ротора, тем самым направляя ток обратно на последний ротор. Так, после этого электрический сигнал пойдёт в обратном направлении, пройдя через все роторы повторно. 
%Во время Второй мировой войны было создано 2 рефлектора, представленных в таблице
%
%\begin{table}[h]
%\small
%\setlength{\tabcolsep}{3pt}
%	\begin{center}
%		\begin{threeparttable}
%		\captionsetup{justification=raggedright,singlelinecheck=off}
%		\caption{\label{tbl:reflectors} Преобразования роторов <<Энигмы>>}
%		\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|}
%			\hline
%			Рефлектор & A & B & C & D & E & F & G & H & I & J & K & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z \\
%			\hline
%			I & F & V & P & J & I & A & O & Y & E & D & R & Z & X & W & G & C & T & K & U & Q & S & B & N & M & H & L \\
%			\hline
%			II & Y & R & U & H & Q & S & L & D & P & X & N & G & O & K & M & I & E & B & F & Z & C & W & V & J & A & T \\
%			\hline
%		\end{tabular}
%		\end{threeparttable}
%	\end{center}
%	
%\end{table}
%
%\subsection{Коммутационная панель}
%
%Коммутационная панель позволяет оператору шифровальной машины варьировать содержимое проводов, попарно соединяющих буквы английского алфавита. 
%Эффект состоял в том, чтобы усложнить работу машины, не увеличивая число роторов.
%Так, если на коммутационной панели соединены буквы 'A' и 'Z', то каждая буква 'A', проходящая через коммутационную панель, будет заменена на 'Z'  и наоборот. Сигналы попадали на коммутационную панель 2 раза: в начале и в конце обработки отдельного символа.

%\section{Алгоритм работы}

В данной работе будет подразумеваться, что у оператора машины есть выбор из 10 роторов и 2 рефлекторов, а также 10 соединительных проводов для коммутационной панели.

Вот последовательность действий, приводящих к обработке сигнала:
\begin{enumerate}
	\item Выбор из 10 роторов трёх нужных, из 2 рефлекторов одного, а также настройка коммутационной панели.
	\item Нажатие одной из 26 клавиш, обозначающих буквы английского алфавита. Замыкается контакт и отправляется соответствующий нажатой клавише электрический сигнал.
	\item Код нажатой клавиши преобразовывается на коммутационной панели в код другой буквы и передаётся дальше.
	\item Код полученной буквы складывается по модулю 26 с кодом буквы, стоящей на первом роторе. Это значение отправляется на первый ротор.
	\item Осуществляется преобразование на первом роторе.
	\item Код полученной после первого ротора буквы складывается по модулю 26 с кратчайшим расстоянием от буквы второго ротора до буквы первого ротора. Это значение отправляется на второй ротор.
	\item Осуществляется преобразование на втором роторе.
	\item Код полученной после второго ротора буквы складывается по модулю 26 с кратчайшим расстоянием от буквы третьего ротора до буквы второго ротора. Это значение отправляется на третий ротор.
	\item Осуществляется преобразование на третьем роторе.
	\item Код полученной после третьего ротора буквы вычитается по модулю 26 с значением на третьем роторе. Это значение отправляется на рефлектор.
	\item Осуществляется преобразование на рефлекторе. Это значение подаётся на третий ротор с обратной стороны.
	\item Код полученной после рефлектора буквы складываются по модулю 26 с значением на третьем роторе. Это значение отправляется на третий ротор с обратной стороны.
	\item Осуществляется обратное пребразование на третьем роторе.
	\item Код полученной после третьего ротора буквы складывается по модулю 26 с кратчайшим расстоянием от буквы третьего ротора до буквы второго ротора. Это значение отправляется на второй ротор с обратной стороны.
	\item Осуществляется обратное пребразование на втором роторе.
	\item Код полученной после второго ротора буквы складывается по модулю 26 с кратчайшим расстоянием от буквы второго ротора до буквы первого ротора. Это значение отправляется на первый ротор с обратной стороны.
	\item Осуществляется обратное пребразование на первом роторе.
	\item Код полученной после первого ротора буквы вычитается по модулю 26 со значением на первом роторе. Это значение отправляется на коммутационную панель.
	\item Осуществляется преобразование на коммутационной панели.
	\item Первый ротор проворачивается на одну позицию. Если он совершил полный оборот, второй ротор поворачивается на одну позицию. Если второй ротор совершил полный оборот, третий ротор поворачивается на одну позицию.
\end{enumerate}

%Рассмотрим пример преобразования буквы 'A' при отсутствии соединений на коммутационной панели, при выборе роторов I, II и III из таблицы \ref{tbl:rotors} для первого, второго и третьего ротора соответственно, а также для начальных значений роторов 'R', 'V' и 'C' соответственно:
%
%\begin{enumerate}
%	\item Буква 'A' проходит через коммутационную панель и остаётся буквой 'A'.
%	\item Код буквы 'A' складывается по модулю с кодом буквы 'R' на первом роторе. Получается буква 'R'.
%	\item Буква 'R' на первом роторе преобразовывается в букву 'U'.
%	\item Код буквы 'U' складывается по модулю 26 с кратчайшим расстоянием от буквы 'V' до буквы 'R'. Получается буква 'Y'.
%	\item Буква 'Y' на втором роторе преобразовывается в букву 'O'.
%	\item Код буквы 'O' складывается по модулю 26 с кратчайшим расстоянием от буквы 'C' до буквы 'V'. Получается буква 'V'.
%	\item Буква 'V' на третьем роторе преобразовывается в букву 'M'.
%	\item Код буквы 'M' вычитается по модулю 26 с кодом буквы 'C'. Получается буква 'K'.
%	\item Рефлектор преобразовывает букву 'K' в букву 'N'.
%	\item Буква 'N' складывается по модулю 26 с кодом буквы 'C'. Получается буква 'P'.
%	\item Буква 'P' на третьем роторе обратно преобразовывается в букву 'H'.
%	\item Код буквы 'H' вычитается по модулю 26 с кратчайшим расстоянием от буквы 'C' до буквы 'V'. Получается буква 'A'.
%	\item Буква 'A' на втором роторе обратно преобразовывается в букву 'A'.
%	\item Код буквы 'A' вычитается по модулю 26 с кратчайшим расстоянием от буквы 'V' до буквы 'R'. Получается буква 'W'.
%	\item Буква 'W' на первом роторе обратно преобразовывается в букву 'N'.
%	\item Код буквы 'N' вычитается по модулю 26 с кодом буквы 'R'. Получается буква 'W'.
%	\item Первый ротор вращается, теперь на нём стоит значение 'С'.
%\end{enumerate}
%
%Так, буква 'A' преобразовалась в букву 'W'. Дешифрация сообщений с использованием шфировальной машины <<Энигма>> осуществляется тем же образом, что и шифрация, только сначала при помощи вводного колеса устанавливается начальное значение роторов. Так, при значениях роторов 'R', 'V' и 'C' соответственно, буква 'W' будет преобразована обратно в букву 'A'.

%\section{Общее число комбинаций}
%
%Рассмотрим 3 значения: количество комбинаций роторов в машине, количество комбинаций положений роторов и количество возможных способов соединения проводов на коммутационной панели. 
%
%Количество комбинаций роторов будет вычисляться по формуле (\ref{for:rotors}).
%\begin{equation}
%	\label{for:rotors}
%	C_{rotors} = 10 \cdot 9 \cdot 8 = 720.
%\end{equation}
%
%Количество комбинаций положений роторов будет вычисляться по формуле (\ref{for:rotors_positions}).
%\begin{equation}
%	\label{for:rotors_positions}
%	C_{positions} = 26 \cdot 26 \cdot 26 = 17576.
%\end{equation}
%
%Количество возможных способов соединения проводов на коммутационной панели будет вычисляться по формуле (\ref{for:commutation}).
%\begin{equation}
%	\label{for:commutation}
%	C_{commutation} = \frac{26!}{6! \cdot 10! \cdot 2^{10}} = 150 738 274 937 250.
%\end{equation}
%
%Итоговое количество комбинаций будет произведением данных трёх параметров и числа 2 (количество комбинаций выбора рефлектора). что будет вычислять по формуле (\ref{for:total}).
%\begin{equation}
%	\label{for:total}
%	C_{total} = 2 \cdot 720 \cdot 17576  \cdot 150 738 274 937 250 = 3 815 101 325 227 832 640 000.
%\end{equation}
%
%Итоговое число комбинаций составляет 3 секстиллиона 815 квинтиллионов 101 квадриллион 325 триллионов 227 миллиардов 832 миллиона 640 тысяч.

\section*{Вывод}

В данном разделе были рассмотрены алгоритм работы шифровальной машины <<Энигма>>, а также её вариант, использованный во время Второй мировой войны, приведён пример преобразования буквы, а также подсчитано количество комбинаций <<Энигмы>> с 3 роторами.

